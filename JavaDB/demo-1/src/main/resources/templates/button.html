<html xmlns:th="http://www.thymeleaf.org">
<head>
</head>
<body>
<p id = "name">hello</p>
<form action = "#" th:action="@{/button}" th:object="${button}" onclick = "connect()">
<input type="submit" value="button" onclick = "connect()"/>
<button onclick = "connect()"> button 2</button>
</form>
<!--
<script src="/webjars/jquery/jquery.min.js"></script>
<script src="/webjars/sockjs-client/sockjs.min.js"></script>
<script src="/webjars/stomp-websocket/stomp.min.js"></script>
-->
<script>
	var ws = null;
	
	function connect() {
	var socket = new WebSocket('ws://localhost:8080/button');
	//ws = Stomp.over(socket);
	console.log("connected");
	document.getElementById('name').innerHTML = "working";

	ws.connect({}, function(frame) {
		ws.subscribe("/user/queue/errors", function(message) {
			alert("Error " + message.body);
		});

		ws.subscribe("/user/button", function(message) {
			showGreeting(message.body);
		});
	}, function(error) {
		alert("STOMP error " + error);
	});
	ws.send("connected");
}

function disconnect() {
    if (ws != null) {
        ws.close();
    }
    setConnected(false);
    console.log("Disconnected");
}

function sendName() {
    ws.send($("#name").val());
}

function showGreeting(message) {
    $("#greetings").append(" " + message + "");
}
</script>
</body>
</html>